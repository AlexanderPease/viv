{% extends "../base.html" %}
{% block page-title %}Home{% end %}
{% block page-description %}Viv Insurance is an online life insurance search engine.{% end %}

{% block body %}
  {{ err }}
  {{ msg }}

  <section class="hero">
    <div class="container">
      <h1>
        No agents. No calls. Life insurance on your terms. 
      </h1>

      <div class="col-sm-6 index-form">
        <form class="form-horizontal" role="form">
          <div class="form-group">
            <label for="age" class="col-sm-2 control-label">Age</label>
            <div class="col-sm-9">
              <div id="age" class="slider"></div>
            </div>
          </div>

          <div class="form-group">
            <label for="gender" class="col-sm-2 control-label">Gender</label>
            <div class="col-sm-9">
              <button type="button" id="female" class="btn">Female</button>
              <button type="button" id="male" class="btn">Male</button>
            </div>
          </div>

          <div class="form-group">
            <label for="kids" class="col-sm-2 control-label">Kids</label>
            <div class="col-sm-9">
              <div id="kids" class="slider"></div>
            </div>
          </div>

          <div class="form-group">
            <label for="income" class="col-sm-2 control-label">Income</label>
            <div class="col-sm-9">
              <div id="income" class="slider"></div>
            </div>
          </div>

          <div class="form-group">
            <label for="height" class="col-sm-2 control-label">Height</label>
            <div class="col-sm-9">
              <div id="height" class="slider"></div>
            </div>
          </div>

           <div class="form-group">
            <label for="weight" class="col-sm-2 control-label">Weight</label>
            <div class="col-sm-9">
              <div id="weight" class="slider"></div>
            </div>
          </div>
        </form>
      </div><!--index-form-->

      <div class="col-sm-6 index-results">
        <h2>Recommended coverage:</h2>
        <div class="panel panel-default">
          <div id="coverage" class="panel-body"></div>
        </div>

        <h2>Your quote:</h2>
        <div class="panel panel-default">
          <div id="quote" class="panel-body">
            <h2>Your quote</h2>
          </div>
        </div>

        <button type="button" id="cta" class="btn btn-primary btn-lg btn-block btn-cta">Learn More</button>
      </div>
    </div>
  </section>

  <div id="cta-modal" class="modal fade">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
        <h4 class="modal-title">Thanks!</h4>
      </div>
      <div class="modal-body">
        Viv isn't quite launched yet, sorry!</br>
        If you give us your email address
        we'll let you know when we're ready. </br></br>

        <!--Visit our <a href="/about">About</a> page to learn why we can provide
        the best rates (hint: it's because we don't have call centers!)</br>-->

        <form role="form">
          <div class="form-group">
            <label for="name">Name</label>
            <input type="text" class="form-control" id="name">
          </div>
          <div class="form-group">
            <label for="email">Email</label>
            <input type="email" class="form-control" id="email">
          </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        <button type="button" id="modal-submit" class="btn btn-primary">Submit</button>
      </div>
    </div><!-- /.modal-content -->
  </div><!-- /.modal-dialog -->
</div><!-- /.modal -->

{% end %}

{% block javascript %}
  <script>
  $(document).ready(function(){
    var SESSION_ID = Math.floor(Math.random()*100000000000);
    var ROOT_URL = 'http://viv-insurance.herokuapp.com/'

    //Sliders
    var $age = $("#age").slider({ max: 100 , value: 35 });
    $age.slider("pips", {
      rest: "label",
      step: 10
    })
    $age.slider("float");

    var $kids = $("#kids").slider({ max: 6 , value: 2 });
    $kids.slider("pips", {
      rest: "label"
    });

    var $income = $("#income").slider({ min: 30, max: 100 , value: 60 });
    $income.slider("pips", {
      rest: "label",
      step: 10,
      prefix: "$",
      suffix: "k"
    });
    $income.slider("float", {
      prefix: "$",
      suffix: "k"
    });

    var height_labels = ["5'0" + '"', "5'1" + '"', "5'2" + '"', "5'3" + '"', "5'4" + '"',
      "5'5" + '"', "5'6" + '"', "5'7" + '"', "5'8" + '"', "5'9" + '"',
      "5'10" + '"', "5'11" + '"', "6'0" + '"', "6'1" + '"', "6'2" + '"', "6'3" + '"',
       "6'4" + '"', "6'5" + '"', "6'6" + '"', "6'7" + '"', "6'8" + '"', "6'9" + '"'
    ];
    var $height = $("#height").slider({ min: 60, max: 80 , value: 64});
    $height.slider("pips", {
      rest: "label",
      step: 3,
      labels: height_labels
    });
    $height.slider("float", {
      labels: height_labels
    });

    var $weight = $("#weight").slider({ min: 100, max: 300 , value: 135 });
    $weight.slider("pips", {
      step: 20,
      suffix: "lbs"
    })
    $weight.slider("float", {
      //suffix: "lbs"
    });

    //Buttons
    $("#female").addClass('btn-primary')
    $("#female").click(function(){
      $(this).addClass('btn-primary');
      $('#male').removeClass('btn-primary');
    });
    $("#male").click(function(){
      $(this).addClass('btn-primary');
      $('#female').removeClass('btn-primary');
    });

    $("#cta").click(function(){
      $('#cta-modal').modal(options);
      var query = "age=" + $("#age").slider("value");
      query = query + "&kids=" + $("#kids").slider("value");
      query = query + "&income=" + (1000 * $("#income").slider("value"));
      query = query + "&height=" + $("#height").slider("value");
      query = query + "&weight=" + $("#weight").slider("value");
      query = query + "&session_id=" + SESSION_ID;
      if ($("#female").hasClass('btn-primary')){
        query = query + "&gender=F";
      } else {
        query = query + "&gender=M";
      }

      /* Submit to server */
      var options = {
        type: 'POST',
        url: ROOT_URL + 'api/addentry?' + query,
        dataType: 'json',
        //headers: {
        //    'X-Session-Token': session.session_token,
        //},
        success: function(response) {
        },
        error: function(response) {
        }
      };
      console.log('Requesting: ' + options.url)
      $.ajax(options);
    });

    $("#modal-submit").click(function(){
      var query = "name=" + $("#name").val();
      query = query + "&email=" + $("#email").val();
      query = query + "&session_id=" + SESSION_ID;
      /* Submit to server */
      var options = {
        type: 'POST',
        url: ROOT_URL + 'api/modalentry?' + query,
        dataType: 'json',
        //headers: {
        //    'X-Session-Token': session.session_token,
        //},
        success: function(response) {
        },
        error: function(response) {
        }
      };
      console.log('Requesting: ' + options.url)
      $.ajax(options);

      // Change modal
      $("#modal-submit").hide();
      $('#cta-modal .modal-body').text('Submitted! Talk to you soon!');
    });

    //Quotes
    $('#coverage').text('$500,000 / 20 years');
    $('#quote').text('Just $20/month!');
  });

  </script>
{% end %}
